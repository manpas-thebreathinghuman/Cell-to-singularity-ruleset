Modified by Manpas based on Rekmod ruleset by ravignir.